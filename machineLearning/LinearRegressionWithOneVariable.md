# å•å˜é‡çº¿æ€§å›å½’ (Linear Regression with One Variable)

å•å˜é‡çº¿æ€§å›å½’ç”¨äºé¢„æµ‹ä¸€ä¸ªè¿ç»­å˜é‡ï¼ˆç›®æ ‡ï¼‰ä¸ä¸€ä¸ªç‰¹å¾ï¼ˆè‡ªå˜é‡ï¼‰ä¹‹é—´çš„çº¿æ€§å…³ç³»ã€‚å®ƒæ˜¯æœºå™¨å­¦ä¹ ä¸­æœ€åŸºç¡€çš„å›å½’æ–¹æ³•ä¹‹ä¸€ï¼Œç›´è§‚ä¸”æ˜“äºç†è§£ã€‚

[ä¸Šä¸€ç« ](./linearRegression.md) --- [ä¸‹ä¸€ç« ](./LinearRegressionWithMultipleVariables.md)

---

è¿™éƒ¨åˆ†ç»“åˆä¸€ä¸ªæˆ¿ä»·éšæˆ¿å­å¤§å°çš„[æ•°æ®é›†](./dateSet/priceBySize_dataset.csv)æ¥ç†è§£ï¼Œ
æ•°æ®éƒ½æ˜¯åˆgrokç”Ÿæˆï¼Œç±»ä¼¼è¿™æ ·

| æˆ¿å­å¤§å°ï¼ˆsqmï¼‰          | æˆ¿ä»·ï¼ˆä¸‡ï¼‰       |
|--------------------|-------------|
| 106.18101782710437 | 118.56568362705848 |
| 192.60714596148742 | 199.32082877338712 |
| 159.79909127171078 | 163.64260844782837 |
| 139.7987726295555  | 141.7877356736626 |


## 1. æ¨¡å‹å½¢å¼

å•å˜é‡çº¿æ€§å›å½’æ¨¡å‹å¯ä»¥è¡¨ç¤ºä¸ºï¼š

$$
y = \theta_0 + \theta_1 x + \epsilon
$$

- $x$ï¼šè‡ªå˜é‡ï¼ˆç‰¹å¾ï¼‰  
- $y$ï¼šå› å˜é‡ï¼ˆç›®æ ‡/æ ‡ç­¾ï¼‰  
- $\theta_0$ï¼šæˆªè·ï¼ˆbiasï¼‰  
- $ \theta_1 $ï¼šæ–œç‡ï¼ˆæƒé‡ï¼‰  
- $\epsilon$ï¼šè¯¯å·®é¡¹ï¼ˆå™ªå£°ï¼‰  

> **ç›®æ ‡**ï¼šé€šè¿‡è®­ç»ƒæ‰¾åˆ°æœ€ä½³å‚æ•° $\theta_0$ å’Œ $\theta_1$ï¼Œ
> ä½¿é¢„æµ‹å€¼ $\hat{y}$ å°½å¯èƒ½æ¥è¿‘çœŸå®å€¼ $y$ã€‚

é€šä¿—è§£é‡Šï¼ˆç»“åˆæˆ¿ä»·ï¼‰:
æƒ³è±¡ä½ æƒ³é¢„æµ‹ä¸€é—´æˆ¿å­çš„ä»·æ ¼ï¼Œæˆ¿é—´å¤§å°æ˜¯å…³é”®å› ç´ ã€‚
æ¨¡å‹å°±åƒä¸€ä¸ªç®€å•çš„å…¬å¼ï¼šåŸºç¡€ä»·ï¼ˆ$\theta_0$ï¼‰+ æ¯å¹³æ–¹ç±³ä»·æ ¼ï¼ˆ$\theta_1$ Ã— å¤§å°ï¼‰= é¢„æµ‹ä»·ã€‚
ä½†ç°å®ä¸­ï¼Œæ€»æœ‰äº›è¯¯å·®ï¼ˆ$\epsilon$ï¼‰ï¼Œå¯èƒ½æ˜¯è£…ä¿®æˆ–ä½ç½®å½±å“ï¼Œ
æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è°ƒæ•´ $\theta_0$ å’Œ $\theta_1$ï¼Œè®©é¢„æµ‹å°½é‡è´´è¿‘å®é™…å–ä»·ã€‚

---

## 2. ä»£ä»·å‡½æ•°/æŸå¤±å‡½æ•°ï¼ˆå‡æ–¹è¯¯å·® MSEï¼‰

ä»£ä»·å‡½æ•°å’ŒæŸå¤±å‡½æ•°åœ¨*`å•å˜é‡çº¿æ€§å›å½’`*çš„è¯­å¢ƒä¸­é€šå¸¸æ˜¯åŒä¸€ä¸ªæ¦‚å¿µï¼ŒäºŒè€…å¸¸äº’æ¢ä½¿ç”¨ã€‚

> é‡ç‚¹è§£é‡Šï¼š åœ¨çº¿æ€§å›å½’ä¸­ï¼Œä»£ä»·å‡½æ•° $ J(\theta_0, \theta_1) $ 
> æŒ‡çš„æ˜¯æ•´ä¸ªæ•°æ®é›†ä¸Šé¢„æµ‹å€¼ä¸çœŸå®å€¼å·®å€¼çš„å¹³å‡åº¦é‡ï¼ˆä¾‹å¦‚å‡æ–¹è¯¯å·® MSEï¼‰ï¼Œ
> è€ŒæŸå¤±å‡½æ•°é€šå¸¸æŒ‡å•ä¸ªæ ·æœ¬çš„è¯¯å·®åº¦é‡ã€‚
> å®é™…åº”ç”¨ä¸­ï¼Œå°¤å…¶åœ¨ä¼˜åŒ–å‚æ•°æ—¶ï¼Œå¸¸ç”¨â€œä»£ä»·å‡½æ•°â€è¡¨ç¤ºæ€»ä½“çš„ä¼˜åŒ–ç›®æ ‡ã€‚

> å…·ä½“è§£é‡Š
> 
> æŸå¤±å‡½æ•°ï¼š
>å¯¹äºå•ä¸ªæ ·æœ¬ $i$ï¼ŒæŸå¤±å‡½æ•°å¯ä»¥å®šä¹‰ä¸º $$ L(\hat{y}^{(i)}, y^{(i)}) = (\hat{y}^{(i)} - y^{(i)})^2 $$
> 
>å…¶ä¸­ $\hat{y}^{(i)} = \theta_0 + \theta_1 x^{(i)}$ æ˜¯é¢„æµ‹å€¼ï¼Œ$ y^{(i)} $ æ˜¯çœŸå®å€¼ã€‚
>
> 
> ä»£ä»·å‡½æ•°ï¼š
>ä»£ä»·å‡½æ•°æ˜¯å¯¹æ‰€æœ‰æ ·æœ¬æŸå¤±çš„å¹³å‡ï¼Œå…¬å¼ä¸ºï¼š
> $$J(\theta_0, \theta_1) = \frac{1}{2m} \sum_{i=1}^m (\hat{y}^{(i)} - y^{(i)})^2$$
> è¿™é‡Œ $ m $ æ˜¯æ ·æœ¬æ€»æ•°ï¼Œ$\frac{1}{2m}$ æ˜¯å½’ä¸€åŒ–å› å­ï¼Œ$\frac{1}{2}$ ä¾¿äºå¯¼æ•°è®¡ç®—ã€‚

ç”¨æ¥è¡¡é‡æ¨¡å‹é¢„æµ‹è¯¯å·®çš„å¸¸ç”¨æŒ‡æ ‡æ˜¯å‡æ–¹è¯¯å·®ï¼ˆMean Squared Error, MSEï¼‰ï¼š

$$
J(\theta_0, \theta_1) = \frac{1}{2m} \sum_{i=1}^m (\hat{y}^{(i)} - y^{(i)})^2
$$

- $m$ï¼šæ ·æœ¬æ•°  
- $\hat{y}^{(i)} = \theta_0 + \theta_1 x^{(i)}$  

> æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æœ€å°åŒ–ä»£ä»·å‡½æ•° $J(\theta_0, \theta_1)$ï¼Œä»è€Œæ‰¾åˆ°æœ€ä¼˜å‚æ•°ã€‚

æœ¯è¯­è§£é‡Š:

1.ä»£ä»·å‡½æ•°å¦‚ä½•äº§ç”Ÿï¼Ÿ
ä»£ä»·å‡½æ•°æ˜¯è¡¡é‡æ¨¡å‹â€œé”™å¾—æœ‰å¤šç¦»è°±â€çš„å·¥å…·ã€‚æˆ‘ä»¬å¸Œæœ›é¢„æµ‹æˆ¿ä»· $\hat{y}$ è·ŸçœŸå®æˆ¿ä»· $y$ è¶Šæ¥è¿‘è¶Šå¥½ã€‚
å·®å€¼ $(\hat{y} - y)$ è¡¨ç¤ºå•æ¬¡é”™è¯¯ï¼Œä½†ç›´æ¥ç”¨å·®å€¼æœ‰æ­£è´ŸæŠµæ¶ˆé—®é¢˜ï¼Œ
æ‰€ä»¥å–å¹³æ–¹ $(\hat{y} - y)^2$ï¼Œæ”¾å¤§è¯¯å·®å½±å“ã€‚
å†å¯¹æ‰€æœ‰æ ·æœ¬æ±‚å¹³å‡ï¼ˆ$\frac{1}{m} \sum$ï¼‰ï¼Œ$\frac{1}{2}$ æ˜¯æ•°å­¦ç®€åŒ–å¯¼æ•°è®¡ç®—ã€‚

2.å¦‚ä½•å¾—åˆ°è¿™ä¸ªå‡½æ•°ï¼Ÿ
è¿™æ˜¯ç»Ÿè®¡å­¦å’Œä¼˜åŒ–ç†è®ºçš„ç»“æœã€‚å‡æ–¹è¯¯å·®æ˜¯å¸¸è§é€‰æ‹©ï¼Œ
å› ä¸ºå®ƒå¯¹å¤§è¯¯å·®æ•æ„Ÿï¼Œä¸”æ•°å­¦ä¸Šä¾¿äºæ±‚å¯¼ï¼Œé€‚åˆçº¿æ€§å›å½’ä¼˜åŒ–ã€‚

é€šä¿—è§£é‡Šï¼ˆç»“åˆæˆ¿ä»·ï¼‰:
ä½ æƒ³ä¹°æˆ¿å­ï¼Œé¢„æµ‹100å¹³ç±³çš„æˆ¿å­è¦120ä¸‡ï¼Œä½†å®é™…å–118ä¸‡ï¼Œä½ å°±â€œçœ‹èµ°çœ¼â€äº†2ä¸‡ã€‚
ä¸ºäº†é˜²æ­¢ä¼°æµ‹é«˜äº†å’Œä½çš„è¯¯å·®æŠµæ¶ˆï¼ŒæŠŠå·®å€¼å¹³æ–¹ä¸€ä¸‹ï¼ˆ2ä¸‡ï¼‰Â²ï¼Œè¿™æ ·ä¸ç®¡æ˜¯é«˜ä¼°è¿˜æ˜¯ä½ä¼°éƒ½ç®—â€œé”™ä¼°â€ã€‚

ç„¶åï¼Œä¸æ˜¯ä¸€å¥—æˆ¿å­ï¼Œè€Œæ˜¯å¾ˆå¤šæˆ¿å­éƒ½é¢„æµ‹ä¸€éã€‚æŠŠæ‰€æœ‰çš„â€œé”™â€åŠ èµ·æ¥ï¼Œå†æ±‚å¹³å‡ï¼Œè¿™ä¸ªæ•°å°±æ˜¯ ä»£ä»·å‡½æ•° 
$J$ã€‚å®ƒå°±åƒä¸€ä¸ªâ€œå¹³å‡é”™è¯¯åˆ†æ•°â€ã€‚
- åˆ†æ•°å¤§ â†’ è¯´æ˜é¢„æµ‹å¾—å¾ˆä¸é è°±ã€‚
- åˆ†æ•°å° â†’ è¯´æ˜é¢„æµ‹è¶Šæ¥è¶Šå‡†ã€‚
æ‰€ä»¥ï¼Œè®­ç»ƒæ¨¡å‹çš„ç›®æ ‡å°±æ˜¯è°ƒæ•´å‚æ•°ï¼ˆç›´çº¿çš„æ–œç‡ã€æˆªè·ï¼‰ï¼Œè®©è¿™ä¸ªåˆ†æ•°å°½é‡ä½ã€‚

>å…¶ä¸­ï¼š
> æŸå¤±å‡½æ•°å°±æ˜¯ä¸€å¥—æˆ¿å­çš„â€œé”™ä¼°å¤šå°‘â€ã€‚
> ä»£ä»·å‡½æ•°å°±æ˜¯â€œæ‰€æœ‰æˆ¿å­çš„å¹³å‡é”™ä¼°å¤šå°‘â€

ğŸ‘‰ æ€»ç»“ä¸€å¥ï¼šä»£ä»·å‡½æ•°å°±æ˜¯â€œå¹³å‡é”™å¤šå°‘â€çš„è¡¡é‡æ ‡å‡†ï¼Œæˆ‘ä»¬è®­ç»ƒå°±æ˜¯ä¸ºäº†æŠŠå®ƒå‹åˆ°æœ€ä½ã€‚

> é‚£ä¹ˆç°åœ¨çš„æ–°é—®é¢˜ï¼Œå¦‚ä½•æ‰èƒ½å°†MSEé™ä½åˆ°æœ€ä½ï¼›
> å¦‚ä½•æ‰èƒ½å¤Ÿè‡ªåŠ¨åœ°æ‰¾å‡ºè¿™äº›ä½¿ä»£ä»·å‡½æ•° J å–æœ€å°å€¼çš„å‚æ•° $\theta_0$ å’Œ $\theta_1$ã€‚ä¹Ÿå°±æ˜¯ä¸‹é¢è¦é™åˆ°çš„æ¢¯åº¦ä¸‹é™ã€‚

---

## 3. æ¢¯åº¦ä¸‹é™

æ¢¯åº¦ä¸‹é™æ˜¯ä¸€ç§è¿­ä»£ä¼˜åŒ–ç®—æ³•ï¼Œç”¨äºæ‰¾åˆ°ä½¿å‡½æ•°å€¼æœ€å°çš„å‚æ•°ã€‚å…¶æ ¸å¿ƒè¡¨è¾¾å¼ä¸ºï¼š

> $$\theta_j := \theta_j - \alpha \frac{\partial J}{\partial \theta_j}, \quad j=0,1$$

$$  \theta_j  $$ ï¼šå¾…ä¼˜åŒ–çš„å‚æ•°ï¼ˆå¦‚æ¨¡å‹ä¸­çš„ $  \theta_0, \theta_1  $ï¼‰

$  \alpha  $ï¼šå­¦ä¹ ç‡ï¼Œæ§åˆ¶æ¯æ¬¡è°ƒæ•´çš„æ­¥é•¿

$  \frac{\partial J}{\partial \theta_j}  $ï¼š
ä»£ä»·å‡½æ•° $  J  $ å¯¹å‚æ•° $  \theta_j  $ çš„åå¯¼æ•°ï¼ŒæŒ‡ç¤ºè¯¯å·®å˜åŒ–æ–¹å‘

é‚£ä¹ˆè¡¨è¾¾å¼å¦‚ä½•å¾—åˆ°çš„å‘¢

1.ä¼˜åŒ–ç›®æ ‡ï¼š æˆ‘ä»¬å¸Œæœ›æœ€å°åŒ–ä»£ä»·å‡½æ•° $  J(\theta_0, \theta_1)  $ï¼Œè¿™æ˜¯ä¸ªå¤šå˜é‡å‡½æ•°ï¼Œ
ç›®æ ‡æ˜¯æ‰¾åˆ° $  \theta_0, \theta_1  $ ä½¿ $  J  $ æœ€å°ã€‚

2.æ¢¯åº¦æ¦‚å¿µï¼š åœ¨æ•°å­¦ä¸­ï¼Œå‡½æ•°çš„æ¢¯åº¦ï¼ˆæ‰€æœ‰åå¯¼æ•°çš„å‘é‡ï¼‰æŒ‡å‘å‡½æ•°å€¼å¢åŠ æœ€å¿«çš„æ–¹å‘ã€‚
æ‰€ä»¥è¿™é‡Œ
$$J(\theta_0, \theta_1) = \frac{1}{2m} \sum_{i=1}^m (\hat{y}^{(i)} - y^{(i)})^2$$
å¯¹$$\theta_j$$æ±‚åå¯¼ï¼Œå¾—åˆ°
$$  \frac{\partial J}{\partial \theta_0} = \frac{1}{m} \sum_{i=1}^m (\hat{y}^{(i)} - y^{(i)})  $$

$$  \frac{\partial J}{\partial \theta_1} = \frac{1}{m} \sum_{i=1}^m (\hat{y}^{(i)} - y^{(i)}) x^{(i)}  $$
è¿™äº›åå¯¼æ•°æ„æˆäº†æ¢¯åº¦å‘é‡ï¼ŒæŒ‡ç¤º $J$ å¢åŠ æœ€å¿«çš„æ–¹å‘ã€‚
å†çœ‹ä¸€ä¸‹æ¢¯åº¦æ¦‚å¿µï¼š 
å‡½æ•°çš„æ¢¯åº¦ $[\frac{\partial J}{\partial \theta_0}, \frac{\partial J}{\partial \theta_1}]$ 
æŒ‡å‘ $J$ å¢åŠ æœ€å¿«çš„æ–¹å‘ã€‚æ²¿è´Ÿæ¢¯åº¦æ–¹å‘ç§»åŠ¨ï¼Œ$J$ ä¼šä¸‹é™ã€‚

æ¥ä¸‹æ¥çš„ç›®æ ‡ï¼š æ¯æ¬¡è¿­ä»£è°ƒæ•´ $\theta_0$ å’Œ $\theta_1$ï¼Œä½¿ $J$ å‡å°

> é€šä¿—è§£é‡Šï¼š æƒ³è±¡ä¸‹å±±ï¼Œè¦æ±‚å¾—çš„æœ€ä½å€¼ä¾¿æ˜¯åˆ°å±±è„šã€‚
> $[\frac{\partial J}{\partial \theta_0}, \frac{\partial J}{\partial \theta_1}]$ å‘Šè¯‰ä½ æœ€å¿«çš„æ–¹å‘ï¼›
> $\frac{\partial J}{\partial \theta_j}$ å‘Šè¯‰ä½ å¡åº¦ï¼Œ
> $\alpha$ åƒä½ è¿ˆçš„æ­¥å­å¤§å°ã€‚æ­¥å­å¤ªå°ï¼ˆ$\alpha$ å°ï¼‰ï¼Œä¸‹å±±æ…¢ï¼›
> æ­¥å­å¤ªå¤§ï¼ˆ$\alpha$ å¤§ï¼‰ï¼Œå¯èƒ½è·³è¿‡è°·åº•æ‘”ä¸‹å»ã€‚

3.æ›´æ–°å…¬å¼ï¼š 

è¿™é‡Œå¼•å…¥ä¸€ä¸ªæ ‡é‡ $\alpha$ æ§åˆ¶æ­¥é•¿ã€‚$\alpha$ æ˜¯å­¦ä¹ ç‡ï¼Œè°ƒèŠ‚è°ƒæ•´å¹…åº¦ã€‚

åŸºæœ¬æ›´æ–°æ€è·¯ï¼š å‚æ•°åº”æœå‡å°‘ $J$ çš„æ–¹å‘ç§»åŠ¨ï¼Œå³ $\theta_j$ å‡å»æŸä¸ªä¸æ¢¯åº¦æˆæ­£æ¯”çš„é‡
(å³$\alpha \frac{\partial J}{\partial \theta_j}$)ã€‚

å…¬å¼æ¨å¯¼ï¼š

- è®¾å‚æ•°æ›´æ–°ä¸º $\theta_j := \theta_j + \Delta \theta_j$
- ç»“åˆå‰é¢çš„åŸºæœ¬æ›´æ–°æ€è·¯ï¼Œä»£å…¥æ›´æ–°ï¼š
$$\theta_j := \theta_j + (-\alpha \frac{\partial J}{\partial \theta_j})$$

åŒ–ç®€ï¼Œå¦‚æ­¤å¾—åˆ°æ ¸å¿ƒè¡¨è¾¾å¼ï¼š
$$\theta_j := \theta_j - \alpha \frac{\partial J}{\partial \theta_j}$$

- é€‚ç”¨æ‰€æœ‰ $\theta_j$ï¼š å…¬å¼å¯¹ $j=0,1$ é€šç”¨ï¼Œæ•…å†™ä½œ $\theta_j := \theta_j - \alpha \frac{\partial J}{\partial \theta_j}, \quad j=0,1$ã€‚


> è¿™é‡Œåœ¨[loveunk çš„æœºå™¨å­¦ä¹ ä¸æ·±åº¦å­¦ä¹ ç¬”è®°](https://github.com/loveunk/machine-learning-deep-learning-notes)
> ä¸­æåˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼š
> 
> å¦‚æœæˆ‘ä»¬é¢„å…ˆæŠŠ $\theta_1$ æ”¾åœ¨ä¸€ä¸ªå±€éƒ¨çš„æœ€ä½ç‚¹ï¼Œä¸‹ä¸€æ­¥æ¢¯åº¦ä¸‹é™æ³•ä¼šæ€æ ·å·¥ä½œï¼Ÿ
> 
> é¦–å…ˆï¼Œç”±äº $\theta_1$ å·²ç»åœ¨æœ€ä½ç‚¹äº†ï¼Œ
> æ‰€ä»¥ $  \frac{\partial J}{\partial \theta_1} = 0  $ï¼Œ
> åç»­è°ƒæ•´é‡ $  \alpha \frac{\partial J}{\partial \theta_1} = 0  $ï¼Œ
> $  \theta_1  $ ä¸å†æ›´æ–°
> 
> å…¶æ¬¡ï¼Œå½“å‰æ¨¡å‹ï¼ˆçº¿æ€§å›å½’ï¼‰çš„ç‰¹æ€§ï¼š 
> äºŒæ¬¡å‡½æ•°çš„ä»£ä»·å‡½æ•°æ˜¯å‡¸å‡½æ•°ï¼ˆå‡è®¾æ•°æ®æ— å†—ä½™ï¼‰ï¼Œæ„å‘³ç€åªæœ‰ä¸€ä¸ªå…¨å±€æœ€ä½ç‚¹ï¼Œ
> æ‰€è°“å±€éƒ¨æœ€ä½ç‚¹ä¹Ÿå°±æ˜¯å…¨å±€æœ€ä½ç‚¹
> 
> è¡¥å……ï¼šå³ä½¿æ•°æ®æœ‰å†—ä½™ï¼ˆå¦‚æ‰€æœ‰ $x^{(i)}$ ç›¸åŒï¼‰ï¼Œ
> $J$ å¯èƒ½é€€åŒ–ä¸ºéä¸¥æ ¼å‡¸ï¼Œå­˜åœ¨å¹³å¦åŒºåŸŸï¼Œä½†ä»æ— å±€éƒ¨æœ€ä½ç‚¹ï¼Œä»…å½±å“å”¯ä¸€æ€§ã€‚

---

## 4. [Python ç¤ºä¾‹](./example/trainingUnivariateLinearRegressionModel.py)

é‡‡ç”¨grokç”Ÿæˆçš„[æ•°æ®é›†](./dateSet/priceBySize_dataset.csv)ï¼Œä½¿ç”¨ `scikit-learn` è®­ç»ƒå•å˜é‡çº¿æ€§å›å½’æ¨¡å‹ï¼š 

**ç”Ÿæˆçš„å¯è§†åŒ–ç¤ºæ„**
<div align="center">
    <img src="./images/example_UnivariateLinearRegressionModel.png" alt="å›¾ç¤º" style="width: 90%; max-width: 600px; min-width: 300px;">
</div>

**ç”Ÿæˆç»“æœç¤ºä¾‹ï¼š**
> æ¨¡å‹ç³»æ•°ï¼ˆæ–œç‡ $b_1$ï¼‰ï¼š 0.9851044002568737
> 
> æ¨¡å‹æˆªè·ï¼ˆ$b_0$ï¼‰ï¼š 6.711672731845184
> 
> é¢„æµ‹ 150 å¹³æ–¹ç±³çš„æˆ¿ä»·çº¦ä¸º 154.48 ä¸‡å…ƒ

---
[ä¸Šä¸€ç« ](./linearRegression.md) --- [ä¸‹ä¸€ç« ](./LinearRegressionWithMultipleVariables.md)
